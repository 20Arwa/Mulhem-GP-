{% extends "base.html" %}
{% block title %}ุชุนุฏูู ูุตุชู{% endblock %}
{% block styles %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/writing/self-writing.css') }}">
	<style>
		.edit-user-story .cover-page  {
			display: block;
		}
	</style>
{% endblock %}
{% block body %}
<div class="page-title container mt-5 ">ุตูุญุฉ ุชุนุฏูู ุงููุชุงุจุฉ</div>
<div class="container self-writing edit-user-story mb-5 p-4 py-5 position-relative"  data-story-id="{{story.id}}" data-story-type="{{story.type}}">
	<div class="book-container position-relative">
		<i id="prevButton" class="fa-regular fa-circle-right position-absolute top-50 end-0 me-3 z-3" data-bs-toggle="tooltip" data-bs-custom-class="custom-tooltip" data-bs-placement="top" data-bs-title="ุงุถุบุท ูุชูุชูู ููุตูุญุฉ ุงูุณุงุจูุฉ"></i>
		<i id="nextButton" class="fa-regular fa-circle-left position-absolute top-50 start-0 ms-3 z-3" data-bs-toggle="tooltip" data-bs-custom-class="custom-tooltip" data-bs-placement="top" data-bs-title="ุงุถุบุท ูุชูุชูู ููุตูุญุฉ ุงูุชุงููุฉ"></i>
		<div class="scene">
				<article class="book">
					<section class="page active cover-page">
						<div class="front">
                            <!-- Title -->
                            {% if story.title == None %}
                                <input class="button title" type="text" name="title" placeholder="ุนููุงู ุงููุตุฉ" value="">
                            {% else %}
                                <input class="button title" type="text" name="title" placeholder="ุนููุงู ุงููุตุฉ" value="{{story.title}}">
                            {% endif %}
                            <!-- Cover Image -->
							<div class="cover-img-container img-container">
                                {% if story.imgSrc == "" %}
								<img class="img cover-img" src=""> 
                                {% else %}
								    <img class="img cover-img" src="../../static/{{story.imgSrc}}"> 
                                {% endif %}
								<div class="no-cover-msg">ูุง ููุฌุฏ ุบูุงู ูููุตุฉ. <br>ุงุถุบุท ุฃุญุฏ ุงูุฒุฑูู ุฃุฏูุงู ููููุดุฆ ูููููู ุตูุฑุฉ ููุ <br>ุฃู ุงุฑูุน ุตูุฑุฉ ูู ุฌูุงุฒู.</div>
							</div>
							<div class="buttons d-flex align-items-center justify-content-center">
								<button class="generate-coverImage-btn button active"><i class="fa-solid fa-folder-plus"></i> ุชูููุฏ ุตูุฑุฉ</button>
								<button class="upload-coverImage-btn button active">
									<i class="fa-solid fa-upload"></i>
									<input type="file" id="imageUpload" accept="image/*" placeholder="ุบูุงู ุงููุตุฉ"> 
									ุฑูุน ุตูุฑุฉ 
								</button>
								<button class="delete-coverImage-btn button"><i class="fa-solid fa-circle-minus"></i> ุญุฐู ุงูุตูุฑุฉ</button>
							</div>
						</div>
						<div class="back">
							<div class="text" contenteditable="true">{{story.content[0]}}</div>
							<div class="correction-word" title="ุงููุฑ ููุชุตุญูุญ"></div>
							<div class="counter-sound">
								<div class="text-counter">ุนุฏุฏ ุงูุฃุญุฑู: <span class="charCount">0</span>/<span class="maxLength">500</span></div>
								<audio class="story-audio rounded-4" controls controlslist="nodownload noplaybackrate">
									<source id="audioSource" src="../../static/{{story.generAudios[0]}}" type="audio/mpeg">
									ุงููุชุตูุญ ุงูุฎุงุต ุจู ูุง ูุฏุนู ุนูุตุฑ ุงูุตูุช
								</audio>
							</div>
							<span class="error-msg text-error-msg">ููุฏ ูุตูุช ุฅูู ุงูุญุฏ ุงูุฃูุตู ูู ุงูุญุฑูู. ุฃุถู ุตูุญุฉ ุฌุฏูุฏุฉ.</span>
							<div class="corrcet-audio-buttons mt-2">
								<button class="correction-btn">ุตุญุญ ุฃุฎุทุงุฆู</button>
								<button class="generate-audio-btn">ุชูููุฏ ุงูุตูุช</button>
							</div>
						</div>
					</section>
                    <!-- Rest Of Pages -->
                    {% for index in range(1, story.content|length, 2) %}
                    <section class="page">
                        <div class="front">
                            <div class="text fs-5" contenteditable="true">{{story.content[index]}}</div>
                            <div class="correction-word" title="ุงููุฑ ููุชุตุญูุญ"></div>
                            <div class="counter-sound">
                                <div class="text-counter">ุนุฏุฏ ุงูุฃุญุฑู: <span class="charCount">0</span>/<span class="maxLength">500</span></div>
								<audio class="story-audio rounded-4" controls controlslist="nodownload noplaybackrate">
									<source id="audioSource" src="../../static/{{story.generAudios[index]}}" type="audio/mpeg">
									ุงููุชุตูุญ ุงูุฎุงุต ุจู ูุง ูุฏุนู ุนูุตุฑ ุงูุตูุช
								</audio>
                            </div>
                            <span class="error-msg text-error-msg">ููุฏ ูุตูุช ุฅูู ุงูุญุฏ ุงูุฃูุตู ูู ุงูุญุฑูู. ุฃุถู ุตูุญุฉ ุฌุฏูุฏุฉ.</span>
                            <div class="corrcet-audio-buttons mt-2">
								<button class="correction-btn">ุตุญุญ ุฃุฎุทุงุฆู</button>
								<button class="generate-audio-btn">ุชูููุฏ ุงูุตูุช</button>
							</div>
                        </div>
                        <div class="back">
                            <div class="text fs-5" contenteditable="true">
                                {% if index + 1 < story.content|length %}
                                {{ story.content[index + 1] }}
                                {% endif %}
                            </div>
                            <div class="correction-word" title="ุงููุฑ ููุชุตุญูุญ"></div>
                            <div class="counter-sound">
                                <div class="text-counter">ุนุฏุฏ ุงูุฃุญุฑู: <span class="charCount">0</span>/<span class="maxLength">500</span></div>
								<audio class="story-audio rounded-4" controls controlslist="nodownload noplaybackrate">
									<source id="audioSource" src="../../static/{{story.generAudios[index + 1]}}" type="audio/mpeg">
									ุงููุชุตูุญ ุงูุฎุงุต ุจู ูุง ูุฏุนู ุนูุตุฑ ุงูุตูุช
								</audio>
                            </div>
                            <span class="error-msg text-error-msg">ููุฏ ูุตูุช ุฅูู ุงูุญุฏ ุงูุฃูุตู ูู ุงูุญุฑูู. ุฃุถู ุตูุญุฉ ุฌุฏูุฏุฉ.</span>
                            <div class="corrcet-audio-buttons mt-2">
								<button class="correction-btn">ุตุญุญ ุฃุฎุทุงุฆู</button>
								<button class="generate-audio-btn">ุชูููุฏ ุงูุตูุช</button>
							</div>
                        </div>
                    </section>						
                    {% endfor %}
				</article>
			</div>
		</div>
		
		<!-- @@@@@@@@@@@@@ Buttons @@@@@@@@@@@@ -->
		<div class="sitting-buttons">
			<div class="sitting-error-msg error-msg my-2">ุฑุณุงูุฉ ุงูุฎุทุฃ</div>
			<div class="d-flex align-items-center justify-content-center column-gap-2">
				<div class="dropdown allam-help">
					
					{% if user.gender == "ุฃูุซู"%}
					<button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="fa-solid fa-circle-question"></i>ุงุทูุจู ูุณุงุนุฏุฉ ูููููู</button>
					{% else %}
					<button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="fa-solid fa-circle-question"></i>ุงุทูุจ ูุณุงุนุฏุฉ ูููููู</button>
					{% endif %}
					
					<ul class="dropdown-menu text-center">
						<li><a class="dropdown-item starting">๐ค ูุง ุฃุนุฑู ุนู ูุงุฐุง ุฃูุชุจ</a></li>
						<li><a class="dropdown-item completion">โ๏ธ ูุง ุฃุนุฑู ููู ุฃููู ูุตุชู</a></li>
						<li><a class="dropdown-item titles" href="#allam-response">๐ก ุงูุชุฑุญ ุนูุงููู ููุตุชู</a></li>
						<li><a class="dropdown-item elements" href="#allam-response">โ ุชุญูู ูู ุนูุงุตุฑ ูุตุชู</a></li>
						<li><a class="dropdown-item feedback" href="#allam-response">โจ ุฑุงุฌุน ูุตุชู ูุงูุชุฑุญ ุชุญุณููุงุช</a></li>
					</ul>
					<img class="mulhem position-absolute" src="../../static/images/mulhem-no-crown.png" alt="ูููู">
				</div>


				<button class="add-page-icon">
					<i class="fa-solid fa-circle-plus"></i>
					ุฅุถุงูุฉ ุตูุญุฉ
				</button>
				<button class="delete-page-icon" disabled>
					<i class="fa-solid fa-circle-minus"></i>
					ุญุฐู ุตูุญุฉ
				</button>


				<div class="record d-flex flex-column align-items-center">
                    <div class="display-voice-record"  data-gender="{{user.gender}}" data-audio-src="{% if story.audioSrc %}../../static/{{ story.audioSrc | safe }}{% else %}""{% endif %}"></div>
                    <div class="d-flex">
                        <div class="controllers-voice-record"></div>
                    </div> 
                </div>
                
                
				<button class="out-btn"><i class="fa-solid fa-right-from-bracket"></i>ุฎุฑูุฌ</button>
				<button class="save-btn"><i class="fa-solid fa-floppy-disk"></i>ุญูุธ</button>
			</div>
		</div>


		<!-- @@@@@@@@@@@@@ Starting Ideas @@@@@@@@@@@@ -->
		<div class="response response-starting p-4 mx-auto mt-5 bg-white rounded-4 position-relative text-center" id="starting-ideas">
			<i class="fa-solid fa-circle-xmark close-icon position-absolute"></i>
			<div class="d-flex justify-content-between mb-5">
				<h3>โจุฃููุงุฑ ุฌูููุฉ ูุชูุชุจ ุนููุง</h3>
			</div>
			<div id="carouselIdeas" class="carousel slide mt-5 p-3 rounded-4">
				<div class="carousel-indicators">
					<button type="button" data-bs-target="#carouselIdeas" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
					<button type="button" data-bs-target="#carouselIdeas" data-bs-slide-to="1" aria-label="Slide 2"></button>
					<button type="button" data-bs-target="#carouselIdeas" data-bs-slide-to="2" aria-label="Slide 3"></button>
					<button type="button" data-bs-target="#carouselIdeas" data-bs-slide-to="3" aria-label="Slide 4"></button>
					<button type="button" data-bs-target="#carouselIdeas" data-bs-slide-to="4" aria-label="Slide 5"></button>
					<button type="button" data-bs-target="#carouselIdeas" data-bs-slide-to="5" aria-label="Slide 6"></button>
					<button type="button" data-bs-target="#carouselIdeas" data-bs-slide-to="6" aria-label="Slide 7"></button>
					<button type="button" data-bs-target="#carouselIdeas" data-bs-slide-to="7" aria-label="Slide 8"></button>
					<button type="button" data-bs-target="#carouselIdeas" data-bs-slide-to="8" aria-label="Slide 9"></button>
					<button type="button" data-bs-target="#carouselIdeas" data-bs-slide-to="9" aria-label="Slide 10"></button>
				  </div>
				<div class="carousel-inner">
					<div class="carousel-item active">
						<h4>๐๐ ููู ูู ุญูุงุชู  ๐๐</h4>
						<p>ุงูุชุจ ุนู ุฃูุซุฑ ุดูุก ูููุฒ ุฃู ูุฎุชูู ุญุฏุซ ุงููููุ ุณูุงุก ูุงู ุฌูุฏูุง ุฃู ุณูุฆูุง</p>
					</div>
					<div class="carousel-item">
						<h4>๐๐ ูููู ุฌุนูู ุณุนูุฏูุง ๐๐</h4>
						<p>ุงุญูู ุนู ูุญุธุฉ ุดุนุฑุช ูููุง ุจุงูุณุนุงุฏุฉ.</p>
					</div>
					<div class="carousel-item">
						<h4>๐งโ๐คโ๐งโจ ูุตุฉ ุนู ุตุฏููู ุงูููุฑุจ โจ๐งโ๐คโ๐ง</h4>
						<p>ุงูุชุจ ุนู ูุบุงูุฑุฉ ุฃู ูููู ููุชุน ุนุดุชู ูุน ุตุฏููู ุงูููุถู.</p>
					</div>
					<div class="carousel-item">
						<h4>๐ถ๐ฑ ุญููุงู ููุถู ๐ฑ๐ถ</h4>
						<p>ุงูุชุจ ุนู ุญููุงูู ุงูููุถู. ูุงุฐุง ููุนูุ ุฃูู ูุนูุดุ</p>
					</div>
					<div class="carousel-item">
						<h4>๐๐๏ธ ุฑุญูุฉ ููุช ุจูุง ๐๏ธ๐</h4>
						<p>ุงุญูู ุนู ููุงู ุฐูุจุช ุฅููู ูุน ุนุงุฆูุชู ุฃู ุฃุตุฏูุงุฆู ููุง ุงูุฐู ุฃุญุจุจุชู ูู ุงูุฑุญูุฉ.</p>
					</div>
					<div class="carousel-item">
						<h4>๐๐ฏ ุญูู ุชุชููู ุชุญูููู ๐ฏ๐</h4>
						<p>ุงุญูู ุนู ุดูุก ุชุญูู ุจุชุญูููู ูู ุงููุณุชูุจู.</p>
					</div>
					<div class="carousel-item">
						<h4>๐ฆธโโ๏ธ๐ก๏ธ ูุบุงูุฑุฉ ุฎูุงููุฉ ๐ก๏ธ๐ฆธโโ๏ธ</h4>
						<p>ุชุฎูู ูุตุฉ ุนู ุจุทู ุฎุงุฑู ุฃู ูุบุงูุฑุฉ ูููุฆุฉ ุจุงูุฅุซุงุฑุฉ ูุงูุฎูุงู.</p>
					</div>
					<div class="carousel-item">
						<h4>๐๏ธ๐ ุฑุญูุฉ ูู ุงูุทุจูุนุฉ ๐๐๏ธ</h4>
						<p>ุชุฎูู ุฃูู ุนูุตุฑ ูู ุงูุทุจูุนุฉุ ูุซู ุงูุฑูุงุญ ุฃู ุงููุทุฑุ ูุงุญูู ูุตุชู.</p>
					</div>
					<div class="carousel-item">
						<h4>๐ป๐ต ุฌูุงู ุงููุจุงุชุงุช ๐ต๐ป</h4>
						<p>ุชุญุฏุซ ุนู ูุจุงุช ุฃู ุฒูุฑุฉ ููุง ุชูุฑ ุจู ุฎูุงู ููููุง.</p>
					</div>
					<div class="carousel-item">
						<h4>๐๐ญ ุญูู ุบุฑูุจ ๐ญ๐</h4>
						<p>ุงุญูู ุนู ุญูู ุบุฑูุจ ุฃู ููุชุน ุฑุฃูุชู ุฃุซูุงุก ูููู.</p>
					</div>
					
				</div>
				<button class="carousel-control-prev" type="button" id="carouselPrev"  data-bs-target="#carouselIdeas" data-bs-slide="prev">
					<i class="fa-regular fa-circle-right"></i>
					<span class="visually-hidden">Previous</span>
				</button>
				<button class="carousel-control-next" type="button" id="carouselNext" data-bs-target="#carouselIdeas" data-bs-slide="next">
					<i class="fa-regular fa-circle-left"></i>
					<span class="visually-hidden">Next</span>
				</button>
			</div>
		</div>

		<!-- Story Completion -->
		<div class="response response-completion p-4 p-4 mx-auto mt-5 bg-white rounded-4 position-relative text-center" id="completion">
			<i class="fa-solid fa-circle-xmark close-icon position-absolute"></i>
			<div class="d-flex justify-content-between mb-5">
				<h3>โ๏ธ๐ุงููุณุงุนุฏุฉ ูู ุงูุฅููุงู:</h3>
			</div>
			<div class="text">
			</div>
		</div>


		<!-- Story Elements -->
		<div class="response response-elements p-4 mx-auto mt-5 bg-white rounded-4 position-relative text-center" id="elements">
			<i class="fa-solid fa-circle-xmark close-icon position-absolute"></i>
			<div class="d-flex justify-content-between mb-5">
				<h3>๐โจุงูุชุญูู ูู ุนูุงุตุฑ ุงููุตุฉ:</h3>
			</div>
			<div class="elements mb-3">
			</div>
		</div>


		<!-- Story Titles -->
		<div class="response response-titles p-4 p-4 mx-auto mt-5 bg-white rounded-4 position-relative text-center" id="titles">
			<i class="fa-solid fa-circle-xmark close-icon position-absolute"></i>
			<div class="d-flex justify-content-between mb-4">
				<h3>๐จโจุนูุงููู ููุชุฑุญุฉ ููุตุชู ุงูุฌูููุฉ:</h3>
			</div>
			<div class="text text-end">
				<ul>
				</ul>
			</div>
		</div>
		
		<!-- Story Feedback -->
		<div class="response response-feedback p-4 p-4 mx-auto mt-5 bg-white rounded-4 position-relative text-center" id="titles">
			<i class="fa-solid fa-circle-xmark close-icon position-absolute"></i>
			<div class="d-flex justify-content-between mb-4">
				<h3>๐โ๏ธ ูุฑุงุฌุนุฉ ุงููุตุฉ:</h3>
			</div>
			<div class="text text-end">
			</div>
		</div>

	</div>
</div>
{% endblock %}
{% block script %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>

<script type="module">
document.addEventListener('DOMContentLoaded', function () {
	// Hide Delete Button If No Cover Image
	if (document.querySelector("img.cover-img").getAttribute('src') == "") {
		document.querySelector(".cover-page .delete-coverImage-btn").style.display = "none";
	}

 
	const addPageBtn = document.querySelector(".add-page-icon"); // Add Page Button
	const deletePageBtn = document.querySelector(".delete-page-icon"); // Delete Page Button

	const nextButton = document.getElementById('nextButton'); // Next Page Button
	const prevButton = document.getElementById('prevButton'); // Prev Page Button

	nextButton.addEventListener('click', nextPage);
	prevButton.addEventListener('click', prevPage);

	// @@@@@@@@@@@ Next Page Button @@@@@@@@@@@
	function nextPage() {
		prevButton.style.display = "inline-block"; // Display Prev Button
	
		const activePage = document.querySelector('.page.active');
		if (activePage) {
			const nextPage = activePage.nextElementSibling;
			
			// ุงุฌุนู ุงูุตูุญุฉ ุงููุดุทุฉ ููููุจุฉ
			activePage.classList.remove('active');
			activePage.classList.add('flipped');
			
			// ุชุญูู ุฅุฐุง ูุงูุช ุงูุตูุญุฉ ุงูุชุงููุฉ ููุฌูุฏุฉ
			if (nextPage && nextPage.classList.contains('page')) {
				nextPage.classList.add('active'); // ุงุฌุนู ุงูุตูุญุฉ ุงูุชุงููุฉ ูุดุทุฉ
				
				// ุชุนุฑูู ุงููุชุบูุฑ ุจุนุฏ ุงูุตูุญุฉ ุงูุชุงููุฉ
				const afterNextPage = nextPage.nextElementSibling;
				
				if (!afterNextPage || !afterNextPage.classList.contains('page')) {
					nextButton.style.display = "none";
				} else {
					nextButton.style.display = "inline-block";
				}
				
				// Add Page Btn
				// ุชุญูู ุฅุฐุง ูุงู ุนุฏุฏ ุงูุตูุญุงุช 20
				const allPages = document.querySelectorAll('.page');
				const errorMsg = document.querySelector(".sitting-error-msg");
				if (allPages.length > 20) {
					nextButton.style.display = "none";
					addPageBtn.setAttribute('disabled', 'disabled'); 
				}
				else {
					addPageBtn.removeAttribute('disabled'); 
				}
					
				// Delete Page Btn
				const activePageIndex = Array.from(allPages).indexOf(nextPage);

				if (activePageIndex === 1) { 
					// ุชูููู ุงูุฒุฑ ุฅุฐุง ูุงูุช afterNextPage ุชุญุชูู ุนูู ุงูุตูุญุงุช ุงููุทููุจุฉ
					deletePageBtn.disabled = !(afterNextPage && afterNextPage.classList.contains('page')); 
				} 
				else if (activePageIndex > 1) {
					// ุชูููู ุงูุฒุฑ ููุตูุญุงุช ุจุนุฏ ุงูุตูุญุฉ ุงูุซุงููุฉ
					deletePageBtn.removeAttribute('disabled'); 
				} 
				else {
					// ุชุนุทูู ุงูุฒุฑ ูุฃู ุญุงูุฉ ุฃุฎุฑู
					deletePageBtn.setAttribute('disabled', 'disabled'); 
				}
			}
		}
	}
	
	// @@@@@@@@@@@ Prev Page Button @@@@@@@@@@@
	function prevPage() {
		const flippedPages = document.querySelectorAll('.page.flipped');
		const activePage = document.querySelector('.page.active');
		const previousPage = activePage.previousElementSibling;
		
		nextButton.style.display = "inline-block"; // Display Next Btn

		// If Prev Page Was The Cover, Hide PRev Btn And Delete
		const beforePreviousPage = previousPage.previousElementSibling;
		if (!beforePreviousPage || !beforePreviousPage.classList.contains('page')) {
			prevButton.style.display = "none"; // Hide Prev Button
			deletePageBtn.setAttribute('disabled', 'disabled'); // Disabled Delete Page Button
			
		}
		
		// Move The Page
		if (flippedPages.length > 0) {
			// ุงุฌุนู ุขุฎุฑ ุตูุญุฉ ููููุจุฉ ูุดุทุฉ ูุฑุฉ ุฃุฎุฑู
			const lastFlippedPage = flippedPages[flippedPages.length - 1];
			lastFlippedPage.classList.remove('flipped');
			lastFlippedPage.classList.add('active');
			
			// ุฅุฒุงูุฉ ุญุงูุฉ ุงููุดุท ูู ุฌููุน ุงูุตูุญุงุช ุงูุฃุฎุฑู
			const allPages = document.querySelectorAll('.page');
			allPages.forEach((page) => {
				if (page !== lastFlippedPage) {
					page.classList.remove('active');
				}
			});
		}
	}
	
	// @@@@@@@@@@@ Add Page Button @@@@@@@@@@@
	addPageBtn.addEventListener("click", () => {
		const book = document.querySelector(".book");
		const newPage = document.createElement("section");
		newPage.className = "page"; // ุฃุถู ูุฆุฉ "page"
		newPage.innerHTML = `
			<div class="front">
				<div class="text" contenteditable="true"></div>
				<div class="counter-sound">
					<div class="text-counter">ุนุฏุฏ ุงูุฃุญุฑู: <span class="charCount">0</span>/<span class="maxLength">500</span></div>
					<audio class="story-audio rounded-4" controls controlslist="nodownload noplaybackrate">
						<source id="audioSource" src="" type="audio/mpeg">
						ุงููุชุตูุญ ุงูุฎุงุต ุจู ูุง ูุฏุนู ุนูุตุฑ ุงูุตูุช
					</audio>
				</div>
				<span class="error-msg text-error-msg">ููุฏ ูุตูุช ุฅูู ุงูุญุฏ ุงูุฃูุตู ูู ุงูุญุฑูู. ุฃุถู ุตูุญุฉ ุฌุฏูุฏุฉ.</span>
				<div class="corrcet-audio-buttons mt-2">
					<button class="correction-btn">ุตุญุญ ุฃุฎุทุงุฆู</button>
					<button class="generate-audio-btn">ุชูููุฏ ุงูุตูุช</button>
				</div>
			</div>
			<div class="back">
				<div class="text" contenteditable="true"></div>
				<div class="counter-sound">
					<div class="text-counter">ุนุฏุฏ ุงูุฃุญุฑู: <span class="charCount">0</span>/<span class="maxLength">500</span></div>
					<audio class="story-audio rounded-4" controls controlslist="nodownload noplaybackrate">
						<source id="audioSource" src="" type="audio/mpeg">
						ุงููุชุตูุญ ุงูุฎุงุต ุจู ูุง ูุฏุนู ุนูุตุฑ ุงูุตูุช
					</audio>
				</div>
				<span class="error-msg text-error-msg">ููุฏ ูุตูุช ุฅูู ุงูุญุฏ ุงูุฃูุตู ูู ุงูุญุฑูู. ุฃุถู ุตูุญุฉ ุฌุฏูุฏุฉ.</span>
				<div class="corrcet-audio-buttons mt-2">
					<button class="correction-btn">ุตุญุญ ุฃุฎุทุงุฆู</button>
					<button class="generate-audio-btn">ุชูููุฏ ุงูุตูุช</button>
				</div>
			</div>
		`;

		
		book.appendChild(newPage); // ุฃุถู ุงูุตูุญุฉ ุงูุฌุฏูุฏุฉ ุฅูู ุงููุชุงุจ

		// Correction Button
		document.querySelectorAll(".page .correction-btn").forEach(btn => {
			btn.addEventListener("click", (e) => {
				e.preventDefault(); // ููุน ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ
				allamCorrection(btn); // ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ ุงูุฎุงุตุฉ
			});
		});

		// Click Generate Audio Button
		document.querySelectorAll(".page .generate-audio-btn").forEach(btn => {
			btn.addEventListener("click", (e) => {
				e.preventDefault(); // ููุน ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ
				generateAudio(btn); // ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ ุงูุฎุงุตุฉ
			});
		});

	// @@@@@@@@@@@ Text Counter @@@@@@@@@@@
	document.querySelectorAll(".text").forEach((textElement) => {
		const parent = textElement.parentElement; // ุงููุตูู ุฅูู ุงูุนูุตุฑ ุงูุฃุจ
		const errorMsg = parent.querySelector(".error-msg.text-error-msg"); // ุฑุณุงูุฉ ุงูุฎุทุฃ ุงูุฎุงุตุฉ ุจุงููุต ุงูุญุงูู
		const textCounterElement = parent.querySelector(".text-counter"); // ุนุฏุงุฏ ุงูุฃุญุฑู ุงูุฎุงุต ุจุงููุต ุงูุญุงูู
		const charCounter = parent.querySelector(".text-counter .charCount"); // ุนุฏุงุฏ ุงูุฃุญุฑู ุงูุฎุงุต ุจุงููุต ุงูุญุงูู
		const maxLengthElement = parent.querySelector(".text-counter .maxLength");
		const maxLength = Number(maxLengthElement?.textContent || 500); // ุงูุญุฏ ุงูุฃูุตู ููุฃุญุฑู
	
		if (textElement) {
			let timeout;
			// ุญุฏุซ ุงูุฅุฏุฎุงู
			textElement.addEventListener("input", () => {
				textCounterElement.style.opacity = "1";
				clearTimeout(timeout); // ุฅูุบุงุก ุงููุคูุช ุงูุณุงุจู
				timeout = setTimeout(() => {
					const currentText = textElement.innerText; // ุงุณุชุฎุฏู innerText ููุญูุงุธ ุนูู ุงูุฃุณุทุฑ ุงูุฌุฏูุฏุฉ
	
					// ุฅุฐุง ุชุฌุงูุฒ ุงููุต ุงูุญุฏ ุงูุฃูุตู
					if (currentText.length > maxLength) {
						// ูุทุน ุงููุต ุฅูู ุงูุญุฏ ุงูุฃูุตู ูุน ุงูุญูุงุธ ุนูู ุงูุชูุณูู
						const trimmedText = currentText.slice(0, maxLength);
						textElement.innerText = trimmedText;
	
						console.log("dkfjei")
						errorMsg.style.opacity = 1;
						errorMsg.innerHTML = "ููุฏ ูุตูุช ุฅูู ุงูุญุฏ ุงูุฃูุตู ูู ุงูุญุฑูู. ุฃุถู ุตูุญุฉ ุฌุฏูุฏุฉ.";
	
						// ุฅุนุงุฏุฉ ุงููุคุดุฑ ุฅูู ููุงูุฉ ุงููุต
						const range = document.createRange();
						const selection = window.getSelection();
						range.selectNodeContents(textElement);
						range.collapse(false);
						selection.removeAllRanges();
						selection.addRange(range);
					} else {
						errorMsg.style.opacity = 0;
					}
					// ุชุญุฏูุซ ุนุฏุงุฏ ุงูุฃุญุฑู
					if (charCounter) charCounter.textContent = currentText.length;
				}, 100); // ุชุฃุฎูุฑ ุจุณูุท ูุชุญุณูู ุงูุฃุฏุงุก
			});
	
			// ููุน ูุตู ุงููุตูุต ุงูุชู ุชุชุฌุงูุฒ ุงูุญุฏ ุงูุฃูุตู
			textElement.addEventListener("paste", (event) => {
				event.preventDefault();
				let pastedText = event.clipboardData
					.getData("text")
					.slice(0, maxLength - textElement.innerText.length); // ุงุณุชุฎุฏู innerText ุจุฏู textContent
				document.execCommand("insertText", false, pastedText);
			});
		}
	});
		nextPage(); // ุงูุงูุชูุงู ุฅูู ุงูุตูุญุฉ ุงูุชุงููุฉ
	});
	

	// @@@@@@@@@@@ Delete Page Button @@@@@@@@@@@	
	deletePageBtn.addEventListener("click", () => {
		Swal.fire({
			title: 'ุญุฐู ุงูุตูุญุฉ',
			text: 'ูู ุฃูุช ูุชุฃูุฏ ุฃูู ุชุฑูุฏ ุญุฐู ูุฐู ุงูุตูุญุฉุ ูุง ูููู ุงูุชุฑุงุฌุน ุนู ูุฐุง ุงูุฅุฌุฑุงุก.',
			icon: 'warning',
			showCancelButton: true,
			confirmButtonText: 'ูุนูุ ุงุญุฐููุง',
			cancelButtonText: 'ุฅูุบุงุก',
			reverseButtons: true, // ุชุจุฏูู ุฃูุงูู ุงูุฃุฒุฑุงุฑ
		}).then((result) => {
			if (result.isConfirmed) {
				const currentSection = document.querySelector(".page.active");
				if (currentSection) {
					// ุงูุงูุชูุงู ุฅูู ุงูุตูุญุฉ ุงูุณุงุจูุฉ
					prevPage();
	
					// ุชุญุฏูุซ ุญุงูุฉ ุงูุฃุฒุฑุงุฑ ุจุนุฏ ุงูุญุฐู
					const activePage = document.querySelector('.page.active');
					const previousPage = activePage.previousElementSibling;
					const beforePreviousPage = previousPage?.previousElementSibling;
	
					if (!beforePreviousPage || !beforePreviousPage.classList.contains('page')) {
						nextButton.style.display = "none"; // ุฅุฎูุงุก ุฒุฑ ุงูุตูุญุฉ ุงูุชุงููุฉ
						deletePageBtn.setAttribute('disabled', 'disabled'); // ุชุนุทูู ุฒุฑ ุงูุญุฐู
					}
	
					// ุญุฐู ุงูุตูุญุฉ ุงูุญุงููุฉ
					currentSection.remove();
					console.log('ุชู ุญุฐู ุงูุตูุญุฉ.');
				} else {
					Swal.fire({
						icon: 'error',
						title: 'ุฎุทุฃ',
						text: 'ูุง ุชูุฌุฏ ุตูุญุฉ ูุดุทุฉ ูุญุฐููุง!',
					});
				}
			} else {
				console.log('ุชู ุฅูุบุงุก ุนูููุฉ ุงูุญุฐู.');
			}
		});
	});


	// @@@@@@@@@@@ @@@@@@@@@@@ Recive And Send Data To Python @@@@@@@@@@@ @@@@@@@@@@
	// @@@@@@@@@@@ Upload Cover Page Image @@@@@@@@@@@
	const uploadBtn = document.querySelector('.cover-page .upload-coverImage-btn');
	const uploadInput = document.querySelector('.cover-page .upload-coverImage-btn input');
	const deleteCoverBtn = document.querySelector(".cover-page .delete-coverImage-btn");
	const coverImage = document.querySelector(".cover-page .cover-img-container img");


	
	// No Cover Message

	// When Enter The Page
	if (coverImage.getAttribute("src") != "") {
		document.querySelector(".no-cover-msg").style.opacity = 0;
	} 
	else {
		document.querySelector(".no-cover-msg").style.opacity = 1;
	}
	
	// On Change
	const observer = new MutationObserver(() => {
		if (coverImage.getAttribute("src")) {
			document.querySelector(".no-cover-msg").style.opacity = 0;
		} else {
			document.querySelector(".no-cover-msg").style.opacity = .60;
		}
	});
	observer.observe(coverImage, { attributes: true });
	
	// Click Uplaod
	uploadBtn.addEventListener('click', () => {
		uploadInput.click(); // ูููุฑ ุนูู ุงูุฅุฏุฎุงู ุงููุฎูู
	});

	uploadInput.addEventListener('change', async function (event) {
		const file = event.target.files[0];

		if (!file) return; // ุชุฃูุฏ ูู ูุฌูุฏ ููู ูุฑููุน

		// ุชุญูู ุฅุฐุง ูุงูุช ููุงู ุตูุฑุฉ ููุฌูุฏุฉ ุจุงููุนู
		if (coverImage.getAttribute("src")) {
			const result = await Swal.fire({
				title: 'ุชุบููุฑ ุงูุตูุฑุฉ',
				text: 'ูู ุฃูุช ูุชุฃูุฏ ุฃูู ุชุฑูุฏ ุชุบููุฑ ุงูุตูุฑุฉุ ุฅุฐุง ูุนูุช ุฐููุ ุณูุชู ุงุณุชุจุฏุงู ุงูุตูุฑุฉ ุงูุญุงููุฉ ุจุตูุฑุฉ ุฌุฏูุฏุฉ.',
				icon: 'info',
				showCancelButton: true, // ุฅุธูุงุฑ ุฒุฑ ุงูุฅูุบุงุก
				confirmButtonText: 'ูุนู',
				cancelButtonText: 'ูุง',
				reverseButtons: true // ุชุจุฏูู ุฃูุงูู ุฃุฒุฑุงุฑ ุงูุชุฃููุฏ ูุงูุฅูุบุงุก
			});
			
			if (!result.isConfirmed) {
				return; // ุฅุฐุง ุงุฎุชุงุฑ ุงููุณุชุฎุฏู "ูุง"ุ ุชููู ุงูุนูููุฉ
			}
		}


		// Show Delete Button
		deleteCoverBtn.style.display = "block";

		const reader = new FileReader();
		reader.onload = async function (e) {
		coverImage.src = e.target.result; // ุนุฑุถ ุงูุตูุฑุฉ ูู ุงูุตูุญุฉ ูุคูุชูุง

			try {
				const formData = new FormData();
				formData.append('image', file);

				const response = await fetch('http://127.0.0.1:5000/save-uploaded-img', {
					method: 'POST',
					body: formData
				});

				if (!response.ok) {
					throw new Error('ูุดู ุงูุงุชุตุงู ุจุงูุฎุงุฏู. ุญุงูู ูุฑุฉ ุฃุฎุฑู.');
				}
				const result = await response.json();
				coverImage.setAttribute("src", `${result.file_path}?t=${new Date().getTime()}`); // ุชุนููู ุงููุณุงุฑ ููุตูุฑุฉ ุงูุฌุฏูุฏุฉ ูู ุงูุณูุฑูุฑ
			} catch (error) {
				console.error('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฑูุน ุงูุตูุฑุฉ:', error);
			}
		};
		reader.readAsDataURL(file); // ูุฑุงุกุฉ ุงูููู ูุนุฑุถู ูุคูุชูุง
	});


	// @@@@@@@@@@@ Generate Image @@@@@@@@@@@
	async function generateCoverImg() {
		const img = document.querySelector(".page.cover-page img");
		// ุชุญูู ุฅุฐุง ูุงูุช ููุงู ุตูุฑุฉ ููุฌูุฏุฉ ุจุงููุนู
		if (img.getAttribute("src")) {
			const result = await Swal.fire({
				title: 'ุชุบููุฑ ุงูุตูุฑุฉ',
				text: 'ูู ุฃูุช ูุชุฃูุฏ ุฃูู ุชุฑูุฏ ุชุบููุฑ ุงูุตูุฑุฉุ ุฅุฐุง ูุนูุช ุฐููุ ุณูุชู ุงุณุชุจุฏุงู ุงูุตูุฑุฉ ุงูุญุงููุฉ ุจุตูุฑุฉ ุฌุฏูุฏุฉ.',
				icon: 'info',
				showCancelButton: true, // ุฅุธูุงุฑ ุฒุฑ ุงูุฅูุบุงุก
				confirmButtonText: 'ูุนู',
				cancelButtonText: 'ูุง',
				reverseButtons: true // ุชุจุฏูู ุฃูุงูู ุฃุฒุฑุงุฑ ุงูุชุฃููุฏ ูุงูุฅูุบุงุก
			});
			if (!result.isConfirmed) {
				return; // ุฅุฐุง ุงุฎุชุงุฑ ุงููุณุชุฎุฏู "ูุง"ุ ุชููู
			}
		}
	
	

		// Get All Text
		const AllStory = document.querySelectorAll(".page .text");
		let fullStory = "";
		AllStory.forEach(text => {
			fullStory += text.textContent.trim() + " ";
		});
	
		// Check Text Length
		if (fullStory.trim().length == 0) {
			Swal.fire({
				title: 'ุฎุทุฃ!',
				text: "ูุง ููุฌุฏ ูุต ููุชุญูู ูููุ ุฃุถู ูุตุงู ุฃููุงู",
				icon: 'error',
				confirmButtonText: 'ููุงูู',
				reverseButtons: true,
			});
			return;
		} else if (fullStory.length < 250) {
			Swal.fire({
				title: 'ุฎุทุฃ!',
				text: "ุงููุตุฉ ูุตูุฑุฉ! ุญุงูู ูุชุงุจุฉ ุงููุฒูุฏ ูุชูููู ุงูุชุญูู",
				icon: 'error',
				confirmButtonText: 'ููุงูู',
				reverseButtons: true,
			});
			return;
		// Check Arabic 
		} else if (!arabicRegex.test(fullStory)) {
			Swal.fire({
				title: 'ุฎุทุฃ!',
				text: "ูุฌุจ ุฅุฏุฎุงู ุงููุตูุต ุจุงููุบุฉ ุงูุนุฑุจูุฉ ููุท",
				icon: 'error',
				confirmButtonText: 'ููุงูู',
				reverseButtons: true,
			});
			return;
		}
		// ุงููููุงุช ุงููุญุธูุฑุฉ
		if (checkForbiddenWords(fullStory)) {
			return;
		}
	
		// Send To Flask
		const data = { message: fullStory };
	
		// ุฅุธูุงุฑ ุฑุณุงูุฉ ุงูุชุญููู
		Swal.fire({
			title: 'ุฌุงุฑู ุชูููุฏ ุบูุงู ุงููุตุฉ...',
			text: 'ุงูุฑุฌุงุก ุงูุงูุชุธุงุฑ ููููุงู',
			allowOutsideClick: false,
			showConfirmButton: false,
			didOpen: () => {
				Swal.showLoading(); // ุนุฑุถ ุงููุคุดุฑ ุงูุฏุงุฆุฑู
			}
		});
		try {
			const response = await fetch('http://127.0.0.1:5000/generate-cover-img', {
				method: 'POST',
				headers: { 'Content-Type': 'application/json' },
				body: JSON.stringify(data)
			});
			
			Swal.close(); // ุฅุบูุงู ุฑุณุงูุฉ ุงูุชุญููู ุจูุฌุฑุฏ ุงุณุชูุงู ุงูุฑุฏ
			
			if (!response.ok) {
				throw new Error('ูุดู ุงูุงุชุตุงู ุจุงูุฎุงุฏู. ุญุงูู ูุฑุฉ ุฃุฎุฑู.');
			}
			
			const result = await response.json();
			
			// From Allam If Text Unclear
			if (result.response === "False") {
				Swal.fire({
					title: 'ุฎุทุฃ!',
					text: "ุงููุต ุบูุฑ ูููููุ ูุฑุฌู ูุชุงุจุฉ ูุตุฉ ูุงุถุญุฉ",
					icon: 'error',
					confirmButtonText: 'ููุงูู',
					reverseButtons: true,
				});
				return;
			}
			// ูุถุน ุงูุตูุฑุฉ ูู ุตูุญุฉ ุงูุบูุงู
			const coverImage = document.querySelector(".cover-img-container .cover-img");
			coverImage.setAttribute("src", `${result.image_path}?t=${new Date().getTime()}`);

			// Display Delete Button
			deleteCoverBtn.style.display = "block";

		} catch (error) {
			Swal.close(); // ุฅุบูุงู ุฑุณุงูุฉ ุงูุชุญููู ุนูุฏ ุญุฏูุซ ุฎุทุฃ
			Swal.fire({
				title: 'ุฎุทุฃ!',
				text: error.message,
				icon: 'error',
				confirmButtonText: 'ููุงูู',
				reverseButtons: true,
			});
		}
	}
	
	// ุฏุงูุฉ ูุนุฑุถ ุงูุฃุฎุทุงุก
	function showError(message, element) {
		element.innerHTML = message;
		element.style.opacity = 1;
		setTimeout(() => {
			element.style.opacity = 0;
		}, 5000);
	}
	

	// Click Generate Image Button
	document.querySelector(".generate-coverImage-btn").addEventListener("click", (e) => {
			e.preventDefault(); // Prevent page reload
			generateCoverImg();
	});
	// Click On Delete Image
	document.querySelector(".delete-coverImage-btn").addEventListener("click", (e) => {
			e.preventDefault(); // Prevent page reload
			Swal.fire({
				title: 'ุญุฐู ุงูุตูุฑุฉ',
				text: 'ูู ุงูุช ูุชุฃูุฏ ูู ุญุฐู ุงูุตูุฑุฉุ',
				icon: 'info',
				showCancelButton: true,
				confirmButtonText: 'ูุนู ุงุญุฐููุง',
				cancelButtonText: 'ูุง ุชุญุฐููุง',
				reverseButtons: true // Swaps the position of confirm and cancel buttons
			}).then((result) => {
				if (result.isConfirmed) {
					coverImage.setAttribute("src", "");
					document.querySelector(".delete-coverImage-btn").style.display = "none"
				}
			})
	});


	
	
	
	// @@@@@@@@@@@ Generate Audio @@@@@@@@@@@
	async function generateAudio(button) {
		const audio = button.parentElement.parentElement.querySelector(".story-audio");
  		const audioSource = audio.querySelector("source");

		console.log(audio,audioSource)
		console.log(audio.getAttribute("src"),audioSource.getAttribute("src"))
		
		var textElement = button.parentElement.parentElement.querySelector(".text");
		var corrcErrorMsg = button.parentElement.previousElementSibling;
		
		// If Text Is Empty
		if (textElement.textContent.length == 0) {
			corrcErrorMsg.innerHTML = "ูุง ููุฌุฏ ูุต ูุชูููุฏ ุตูุช ููุ ุฃุถู ูุตุงู ุฃููุงู"
			corrcErrorMsg.style.opacity = 1;
			setTimeout(() => {corrcErrorMsg.style.opacity = 0;}, 5000); 
			return;
		}
		// If Text Is Short
		else if (textElement.textContent.length < 10) {
			corrcErrorMsg.innerHTML = "ุงููุตุฉ ูุตูุฑุฉ ุฌุฏุง! ุญุงูู ูุชุงุจุฉ ุงููุฒูุฏ ูุชูููุฏ ุงูุตูุช"
			corrcErrorMsg.style.opacity = 1;
			setTimeout(() => {corrcErrorMsg.style.opacity = 0;}, 5000); 
			return;
		}
		// If Text Is Not Arabic
		else if (!arabicRegex.test(textElement.textContent) ) {
			corrcErrorMsg.innerHTML = "ูุฌุจ ุฅุฏุฎุงู ุงููุตูุต ุจุงููุบุฉ ุงูุนุฑุจูุฉ ููุท";
			corrcErrorMsg.style.opacity = 1;
			setTimeout(() => {corrcErrorMsg.style.opacity = 0;}, 5000); 
			return;
		}
		else {
			corrcErrorMsg.style.opacity = 0; // Remove Error Message
		}
		// ุงููููุงุช ุงููุญุธูุฑุฉ
	 	if (checkForbiddenWords(textElement.textContent)) {
			return;
		}
		// ุชุญูู ุฅุฐุง ูุงู ููุงู ุตูุช ููุฌูุฏ ุจุงููุนู
		if (audioSource.getAttribute("src").trim() != '../../static/' && audioSource.getAttribute("src").trim() != '') {
			const result = await Swal.fire({
				title: 'ุฅุนุงุฏุฉ ุชูููุฏ ุงูุตูุช',
				text: 'ูู ุฃูุช ูุชุฃูุฏ ุฃูู ุชุฑูุฏ ุฅุนุงุฏุฉ ุชูููุฏ ุงูุตูุชุ ุฅุฐุง ูุนูุช ุฐููุ ุณูุชู ุงุณุชุจุฏุงู ุงูุตูุช ุงูุญุงูู ุจุตูุช ุฌุฏูุฏ.',
				icon: 'info',
				showCancelButton: true, // ุฅุธูุงุฑ ุฒุฑ ุงูุฅูุบุงุก
				confirmButtonText: 'ูุนู',
				cancelButtonText: 'ูุง',
				reverseButtons: true // ุชุจุฏูู ุฃูุงูู ุฃุฒุฑุงุฑ ุงูุชุฃููุฏ ูุงูุฅูุบุงุก
			});
	
			if (!result.isConfirmed) {
				return; // ุฅุฐุง ุงุฎุชุงุฑ ุงููุณุชุฎุฏู "ูุง"ุ ุชููู
			}
		}
	

		// Get Index Of Current Page Text
		var allTexts = Array.from(document.querySelectorAll(".page .text"));
		var index = allTexts.indexOf(textElement);

		console.log(index);
		// Send To Flask
		const data = { message: [textElement.textContent,index] };
	
		// ุฅุธูุงุฑ ุฑุณุงูุฉ ุงูุชุญููู
		Swal.fire({
			title: 'ุฌุงุฑู ุชูููุฏ ุงูุตูุช...',
			text: 'ุงูุฑุฌุงุก ุงูุงูุชุธุงุฑ ููููุงู',
			allowOutsideClick: false,
			showConfirmButton: false,
			didOpen: () => {
				Swal.showLoading(); // ุนุฑุถ ุงููุคุดุฑ ุงูุฏุงุฆุฑู
			}
		});
		try {
			const response = await fetch('http://127.0.0.1:5000/generate-story-audio', {
				method: 'POST',
				headers: { 'Content-Type': 'application/json' },
				body: JSON.stringify(data)
			});
			
			Swal.close(); // ุฅุบูุงู ุฑุณุงูุฉ ุงูุชุญููู ุจูุฌุฑุฏ ุงุณุชูุงู ุงูุฑุฏ
			
			if (!response.ok) {
				throw new Error('ูุดู ุงูุงุชุตุงู ุจุงูุฎุงุฏู. ุญุงูู ูุฑุฉ ุฃุฎุฑู.');
			}
			
			const result = await response.json();
			console.log(result, "response from server"); // ุงูุญุต ูุญุชูู ุงูุงุณุชุฌุงุจุฉ
			if (!result.audio_path) {
				console.error("Audio path is undefined or missing!");
				return;
			}

			audioSource.setAttribute("src", `${result.audio_path}?t=${new Date().getTime()}`); // ุชุญุฏูุซ src ูู <source>
			audio.load(); // ุชุญุฏูุซ <audio> ูุชุญููู ุงููุตุฏุฑ ุงูุฌุฏูุฏ
		

		} catch (error) {
			Swal.close(); // ุฅุบูุงู ุฑุณุงูุฉ ุงูุชุญููู ุนูุฏ ุญุฏูุซ ุฎุทุฃ
			Swal.fire({
				title: 'ุฎุทุฃ!',
				text: error.message,
				icon: 'error',
				confirmButtonText: 'ููุงูู',
				reverseButtons: true,
			});
		}
	}
	// Click Generate Audio Button
	document.querySelectorAll(".page .generate-audio-btn").forEach(btn => {
		btn.addEventListener("click", (e) => {
			e.preventDefault(); // ููุน ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ
			generateAudio(btn); // ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ ุงูุฎุงุตุฉ
		});
	});


	
	// @@@@@@@@@@@ Allam Correction @@@@@@@@@@@
	async function allamCorrection(button) {  

		// Check If Cover Page
		if (document.querySelector(".page.active") == document.querySelector(".page:first-of-type")) {
			sittingErrMsg.innerHTML = "ูุง ูููู ุงููุฑุงุฌุนุฉ ูุงูุชุตุญูุญ ูู ุตูุญุฉ ุงูุบูุงู";
			sittingErrMsg.style.opacity = 1;
			setTimeout(() => {sittingErrMsg.style.opacity = 0;}, 5000); 
			return ;
		}
		var textElement = button.parentElement.querySelector(".text");
		var corrcErrorMsg = button.previousElementSibling;
		
		// If Text Is Empty
		if (textElement.textContent.length == 0) {
			corrcErrorMsg.innerHTML = "ูุง ููุฌุฏ ูุต ููุฑุงุฌุนุชูุ ุฃุถู ูุตุงู ุฃููุงู"
			corrcErrorMsg.style.opacity = 1;
			setTimeout(() => {corrcErrorMsg.style.opacity = 0;}, 5000); 
			return;
		}
		// If Text Is Short
		else if (textElement.textContent.length < 10) {
			corrcErrorMsg.innerHTML = "ุงููุตุฉ ูุตูุฑุฉ ุฌุฏุง! ุญุงูู ูุชุงุจุฉ ุงููุฒูุฏ ูุฃุชููู ูู ุชุตุญูุญ ุฃุฎุทุงุฆู"
			corrcErrorMsg.style.opacity = 1;
			setTimeout(() => {corrcErrorMsg.style.opacity = 0;}, 5000); 
			return;
		}
		// If Text Is Not Arabic
		else if (!arabicRegex.test(textElement.textContent) ) {
			corrcErrorMsg.innerHTML = "ูุฌุจ ุฅุฏุฎุงู ุงููุตูุต ุจุงููุบุฉ ุงูุนุฑุจูุฉ ููุท";
			corrcErrorMsg.style.opacity = 1;
			setTimeout(() => {corrcErrorMsg.style.opacity = 0;}, 5000); 
			return;
		}
		else {
			corrcErrorMsg.style.opacity = 0; // Remove Error Message
		}
		// ุงููููุงุช ุงููุญุธูุฑุฉ
	 	if (checkForbiddenWords(textElement.textContent)) {
			return;
		}
		
		// Send To Allam
		const data = { message: textElement.textContent }; 

		 // ุฅุธูุงุฑ ุฑุณุงูุฉ ุงูุชุญููู
		 Swal.fire({
            title: 'ุฌุงุฑู ุงูุชุญูู ูู ุงูุฃุฎุทุงุก...',
            text: 'ุงูุฑุฌุงุก ุงูุงูุชุธุงุฑ ููููุงู',
            allowOutsideClick: false,
            showConfirmButton: false,
            didOpen: () => {
                Swal.showLoading(); // ุนุฑุถ ุงููุคุดุฑ ุงูุฏุงุฆุฑู
            }
        });

		var result = "";		
		try {
            const response = await fetch('http://127.0.0.1:5000/allam-correction', {
				method: 'POST',
				headers: { 'Content-Type': 'application/json' },
				body: JSON.stringify(data)
			});

            Swal.close(); // ุฅุบูุงู ุฑุณุงูุฉ ุงูุชุญููู ุจูุฌุฑุฏ ุงุณุชูุงู ุงูุฑุฏ

            if (!response.ok) {
                throw new Error('ูุดู ุงูุงุชุตุงู ุจุงูุฎุงุฏู. ุญุงูู ูุฑุฉ ุฃุฎุฑู.');
            }

            result = await response.json();
			const jsonObject = JSON.parse(result.response); // Convert String To JSONS

				function highlightErrors(textElement, errorTypes) {
				const textContent = textElement.textContent; // ุงููุต ุงููุงูู
				const words = textContent.split(/(\s+|[,.!?ุุ])/); // ุชูุณูู ุงููุต ุฅูู ูููุงุช ูุนูุงูุงุช ุงูุชุฑููู
				let hasErrors = false; // ูุชุบูุฑ ูุชุชุจุน ูุฌูุฏ ุงูุฃุฎุทุงุก

				// ุฅูุดุงุก ูุญุชูู ุฌุฏูุฏ ูุน ุงูุฃุฎุทุงุก ุงููุญุฏุฏุฉ
				const newContent = words.map(word => {
					// ุงูุจุญุซ ูู ูู ููุน ูู ุงูุฃุฎุทุงุก
					for (const [errorType, errors] of Object.entries(errorTypes)) {
						const error = errors.find(err => err[0] === word && err[0] !== err[1]); // ุงูุจุญุซ ุนู ุงููููุฉ ูู ูุงุฆูุฉ ุงูุฃุฎุทุงุก
						if (error) {
							hasErrors = true; // ุชุญุฏูุฏ ูุฌูุฏ ุงูุฃุฎุทุงุก
							// ุฅุฐุง ููุฌุฏ ุฎุทุฃุ ุฅูุดุงุก <span>
							const span = document.createElement("span");
							span.className = `${errorType}-error position-relative error-word`; // ุฅุถุงูุฉ ููุน ุงูุฎุทุฃ ูู class
							span.dataset.suggestion = error[1]; // ุงูุงูุชุฑุงุญ
							span.textContent = error[0]; // ุงููุต ุงูุฎุงุทุฆ
							span.dataset.errorType = errorType; // ููุน ุงูุฎุทุฃ
							return span.outerHTML; // ุชุญููู ุงูุนูุตุฑ ุฅูู ูุต HTML
						}
					}
					return word; // ุงููููุฉ ุตุญูุญุฉ ุชูุชุฑู ููุง ูู
				}).join(''); // ุฅุนุงุฏุฉ ุชุฌููุน ุงููุตูุต
			
				// ุงุณุชุจุฏุงู ุงููุต ูู ุงูุนูุตุฑ
				textElement.innerHTML = newContent;

				// $$$$$$ If No Errors $$$$$$ 
				if (!hasErrors) {
					Swal.fire({
						title: 'ุฑุงุฆุน ุฌุฏุง!',
						text: 'ูุตู ุฎุงูู ูู ุงูุฃุฎุทุงุกุ ุนููู ููุชุงุฒ! ๐',
						icon: 'success',
						confirmButtonText: 'ุนูุฏุฉ ูููุชุงุจุฉ',
						reverseButtons: true, 
					})
					return;
				}
				else {
					Swal.fire({
						title: 'ุฃุญุณูุช!',
						text: 'ููู ููุงู ุจุนุถ ุงูุฃุฎุทุงุก ุงูุตุบูุฑุฉ. ุงุถุบุท ุนูู ุงูุฃุฌุฒุงุก ุงููููููุฉ ูุชุตุญูุญูุง ูุชุญุณูู ูุตุชู',
						icon: 'info',
						confirmButtonText: 'ุงูุนูุฏุฉ ูุชุตุญูุญ ุงูุฃุฎุทุงุก',
						reverseButtons: true,
					})
				}
			}
			
			highlightErrors(textElement, jsonObject); // ุชุทุจูู ุงูุฏุงูุฉ
			
		
			// Show Correction On Mouse Over
			var correctionWord = document.querySelector(".back .correction-word");	
			textElement.addEventListener('mouseover', (e) => {
				if (e.target.classList.contains('spelling-error') || e.target.classList.contains('grammar-error') || e.target.classList.contains('inappropriate_words-error')) {
					correctionWord.style.display = 'block';
					correctionWord.textContent = `ุงููููุฉ ุงูุตุญูุญุฉ: ${e.target.dataset.suggestion}`;
			
					// ุฅุถุงูุฉ ุญุฏุซ ุงูููุฑ ูุชุนุฏูู ุงููููุฉ ุงููุญุฏุฏุฉ ููุท
					correctionWord.onclick = () => {
						e.target.textContent = e.target.dataset.suggestion;
						e.target.className = ""; // ุฅุฒุงูุฉ ูู ุงูุฃุฎุทุงุก
						correctionWord.style.display = 'none';
					};
				}
			});
		} catch (error) {
            Swal.close(); // ุฅุบูุงู ุฑุณุงูุฉ ุงูุชุญููู ุนูุฏ ุญุฏูุซ ุฎุทุฃ
            // ุนุฑุถ ุฑุณุงูุฉ ุฎุทุฃ
            Swal.fire({
                title: 'ุฎุทุฃ!',
                text: error.message,
                icon: 'error',
                confirmButtonText: 'ููุงูู',
                reverseButtons: true,
            });
        }
	}
	// Click Correction Button
	document.querySelectorAll(".page .correction-btn").forEach(btn => {
		btn.addEventListener("click", (e) => {
			e.preventDefault(); // Prevent page reload
			allamCorrection(btn);
		})
	});

	// @@@@@@@@@@@ Allam Elements @@@@@@@@@@@
	async function allamElements() {  
		var sittingErrMsg = document.querySelector(".sitting-error-msg");

		// Get All Text
		var AllStory = document.querySelectorAll(".page .text");
		var fullStory = "";
		AllStory.forEach(text => {fullStory += text.textContent.trim() + " "})
		
		// If Text Is Empty
		if (fullStory.trim().length == 0) {
			sittingErrMsg.innerHTML = "ูุง ููุฌุฏ ูุต ููุชุญูู ูููุ ุฃุถู ูุตุงู ุฃููุงู"
			sittingErrMsg.style.opacity = 1;
			setTimeout(() => {sittingErrMsg.style.opacity = 0;}, 5000); 
			return;
		}
		// If Text Is Short
		else if (fullStory.length < 150) {
			sittingErrMsg.innerHTML = "ุงููุตุฉ ูุตูุฑุฉ! ุญุงูู ูุชุงุจุฉ ุงููุฒูุฏ ูุชูููู ุงูุชุญูู"
			sittingErrMsg.style.opacity = 1;
			setTimeout(() => {sittingErrMsg.style.opacity = 0;}, 5000); 
			return;
		}
		// If Text Is Not Arabic
		else if (!arabicRegex.test(fullStory) ) {
			sittingErrMsg.innerHTML = "ูุฌุจ ุฅุฏุฎุงู ุงููุตูุต ุจุงููุบุฉ ุงูุนุฑุจูุฉ ููุท";
			sittingErrMsg.style.opacity = 1;
			setTimeout(() => {sittingErrMsg.style.opacity = 0;}, 5000); 
			return;
		}
		// ุงููููุงุช ุงููุญุธูุฑุฉ
		if (checkForbiddenWords(fullStory)) {
			return;
		}
		else {
			sittingErrMsg.style.opacity = 0; // Remove Error Message
		}

		// Send To Allam
		const data = { message: fullStory }; 

		// ุฅุธูุงุฑ ุฑุณุงูุฉ ุงูุชุญููู
		Swal.fire({
			title: 'ุฌุงุฑู ุงูุชุญูู ูู ุนูุงุตุฑ ุงููุตุฉ...',
            text: 'ุงูุฑุฌุงุก ุงูุงูุชุธุงุฑ ููููุงู',
            allowOutsideClick: false,
            showConfirmButton: false,
            didOpen: () => {
                Swal.showLoading(); // ุนุฑุถ ุงููุคุดุฑ ุงูุฏุงุฆุฑู
            }
        });
		
		var result = "";		
		try {
			const response = await fetch('http://127.0.0.1:5000/allam-elements', {
				method: 'POST',
				headers: { 'Content-Type': 'application/json' },
				body: JSON.stringify(data)
			});

            Swal.close(); // ุฅุบูุงู ุฑุณุงูุฉ ุงูุชุญููู ุจูุฌุฑุฏ ุงุณุชูุงู ุงูุฑุฏ
			
            if (!response.ok) {
				throw new Error('ูุดู ุงูุงุชุตุงู ุจุงูุฎุงุฏู. ุญุงูู ูุฑุฉ ุฃุฎุฑู.');
            }
			
            result = await response.json();
			console.log(result)
			//const resultObjenc = result.response.split("Input:")[0].trim();
			//const jsonObject =  JSON.parse(resultObjenc);  // Convert 
			const jsonObject =  JSON.parse(result.response);  // Convert 

			// $$$$$$ If All Elements Exist $$$$$$ 
			if (!result.response.includes("ุบูุฑ ูุฐููุฑ")) {
				Swal.fire({
					title: 'ุฑุงุฆุน ุฌุฏุง!',
					text: 'ูุตุชู ุชุญุชูู ุนูู ุฌููุน ุนูุงุตุฑ ุงููุตุฉ. ุฃุญุณูุช! ๐',
					icon: 'success',
					confirmButtonText: 'ุชููุฏ ุนูุงุตุฑ ูุตุชู',
					reverseButtons: true, 
				})
			}
			else {
				Swal.fire({
					title: 'ุฃุญุณูุช!',
					text: 'ููู ููุงู ุจุนุถ ุงูุนูุงุตุฑ ุงููุงูุตุฉ. ุงูุธุฑ ุฅูู ุงูุงูุชุฑุงุญุงุช ูุชููููุง',
					icon: 'info',
					confirmButtonText: 'ุชููุฏ ุนูุงุตุฑ ูุตุชู',
					reverseButtons: true,
				})
			}

			 // Show Response To User
			const responseElemsContainer = document.querySelector(".response-elements");
			responseElemsContainer.style.display = "block"; // ุนุฑุถ ุงูุญุงููุฉ
		
			// ุชูุธูู ุงูุญุงููุฉ ูุจู ุงูุฅุถุงูุฉ
			const responseElems = document.querySelector(".response-elements .elements");
			responseElems.innerHTML = ""; // ุฅุฒุงูุฉ ุงููุญุชูู ุงูุณุงุจู
		
			// ุชุฑุชูุจ ุงูุนูุงุตุฑ ูุนุฑุถูุง
			const elementOrder = ["ุงูุดุฎุตูุงุช", "ุงูููุงู", "ุงูุฒูุงู", "ุงูุฃุณุจุงุจ", "ุงููุดููุฉ"];
			elementOrder.forEach(key => {
				if (key in jsonObject) {
					const elementDiv = document.createElement("div"); // ุฅูุดุงุก div ููู ุนูุตุฑ
					const title = document.createElement("h5");
					title.innerHTML = key;
					const paragraph = document.createElement("p");
					paragraph.innerHTML = `:&nbsp;${jsonObject[key]}`; // ุนุฑุถ ุงููุต
					elementDiv.appendChild(title);
					elementDiv.appendChild(paragraph);
					responseElems.appendChild(elementDiv); // ุฅุถุงูุฉ ุงูุนูุตุฑ ุฅูู ุงูุญุงููุฉ
				}
			});
		
			// ุงูุงูุชูุงู ุฅูู ุงูุฃุณูู ูุฑุคูุฉ ุงููุชุงุฆุฌ
			const offset = window.innerHeight * 0.1; // 10% ูู ุงุฑุชูุงุน ุงูุดุงุดุฉ
			window.scrollTo({ 
				top: responseElemsContainer.getBoundingClientRect().top + window.pageYOffset - offset, 
				behavior: 'smooth', 
			});
		
		} catch (error) {
			Swal.close(); // ุฅุบูุงู ุฑุณุงูุฉ ุงูุชุญููู ุนูุฏ ุญุฏูุซ ุฎุทุฃ
			Swal.fire({
				title: 'ุฎุทุฃ!',
				text: error.message,
				icon: 'error',
				confirmButtonText: 'ููุงูู',
				reverseButtons: true,
			});
		}
	}
	// Click Elements Button
	document.querySelector(".dropdown.allam-help .elements").addEventListener("click", (e) => {
		e.preventDefault(); // Prevent page reload
		allamElements();
	});
	// Click On Close elements
	document.querySelector(".response-elements .close-icon").addEventListener("click", () => {
		document.querySelector(".response-elements").style.display = "none";
		window.scrollBy({top: -420});	
	});


	// @@@@@@@@@@@ Allam Completion @@@@@@@@@@@
	async function allamCompletion() {
		var sittingErrMsg = document.querySelector(".sitting-error-msg");

		// Get All Text
		var AllStory = document.querySelectorAll(".page .text");
		var fullStory = "";
		AllStory.forEach(text => {fullStory += text.textContent.trim() + " "})
		
		// If Text Is Empty
		if (fullStory.trim().length == 0) {
			sittingErrMsg.innerHTML = "ูุง ููุฌุฏ ูุต ููุชุญูู ูููุ ุฃุถู ูุตุงู ุฃููุงู"
			sittingErrMsg.style.opacity = 1;
			setTimeout(() => {sittingErrMsg.style.opacity = 0;}, 5000); 
			return;
		}
		// If Text Is Short
		else if (fullStory.length < 50) {
			sittingErrMsg.innerHTML = "ุงููุต ูุตูุฑ ุฌุฏุง! ุญุงูู ูุชุงุจุฉ ุงููุฒูุฏ ูุฃุชููู ูู ูุณุงุนุฏุชู"
			sittingErrMsg.style.opacity = 1;
			setTimeout(() => {sittingErrMsg.style.opacity = 0;}, 5000); 
			return;
		}
		// If Text Is Not Arabic
		else if (!arabicRegex.test(fullStory) ) {
			sittingErrMsg.innerHTML = "ูุฌุจ ุฅุฏุฎุงู ุงููุตูุต ุจุงููุบุฉ ุงูุนุฑุจูุฉ ููุท";
			sittingErrMsg.style.opacity = 1;
			setTimeout(() => {sittingErrMsg.style.opacity = 0;}, 5000); 
			return;
		}
		// ุงููููุงุช ุงููุญุธูุฑุฉ
		if (checkForbiddenWords(fullStory)) {
			return;
		}
		else {
			sittingErrMsg.style.opacity = 0; // Remove Error Message
		}

		// Send To Allam
		const data = { message: fullStory }; 

		 // ุฅุธูุงุฑ ุฑุณุงูุฉ ุงูุชุญููู
		Swal.fire({
            title: 'ุฌุงุฑู ุงููุณุงุนุฏุฉ ูู ุงูุฅููุงู...',
            text: 'ุงูุฑุฌุงุก ุงูุงูุชุธุงุฑ ููููุงู',
            allowOutsideClick: false,
            showConfirmButton: false,
            didOpen: () => {
                Swal.showLoading(); // ุนุฑุถ ุงููุคุดุฑ ุงูุฏุงุฆุฑู
            }
        });

		var result = "";		
		try {
            const response = await fetch('http://127.0.0.1:5000/allam-completion', {
				method: 'POST',
				headers: { 'Content-Type': 'application/json' },
				body: JSON.stringify(data)
			});

            Swal.close(); // ุฅุบูุงู ุฑุณุงูุฉ ุงูุชุญููู ุจูุฌุฑุฏ ุงุณุชูุงู ุงูุฑุฏ
			
            if (!response.ok) {
                throw new Error('ูุดู ุงูุงุชุตุงู ุจุงูุฎุงุฏู. ุญุงูู ูุฑุฉ ุฃุฎุฑู.');
            }
			
            result = await response.json();

			Swal.fire({
				title: 'ุชูุช ูุนุงูุฌุฉ ุทูุจู',
				icon: 'success',
				confirmButtonText: 'ุชููุฏ ุงููุณุงุนุฏุฉ',
				reverseButtons: true, 
			})

			// Show Response To User
			var completionContain  = document.querySelector(".response-completion");

			// Go Down To completion
			var offset = window.innerHeight * 0.4; // 30% ูู ุงุฑุชูุงุน ุงูุดุงุดุฉุ ุงุฌุนููุง ุฃูุจุฑ ูุชุฒูุฏ ุงููุณุงูุฉ
			const completionTop = completionContain.getBoundingClientRect().top + window.pageYOffset;
			window.scrollTo({ 
				top: completionTop + offset, // ุฅุถุงูุฉ ุงูู offset ูุฌุนู ุงูุชูุฑูุฑ ููุฒู ุฃูุซุฑ
				behavior: 'smooth' 
			});

			completionContain.style.display = "block";
			completionContain.querySelector(".text").innerHTML = result.response;
		
		} catch (error) {
			Swal.close(); // ุฅุบูุงู ุฑุณุงูุฉ ุงูุชุญููู ุนูุฏ ุญุฏูุซ ุฎุทุฃ
			Swal.fire({
				title: 'ุฎุทุฃ!',
				text: error.message,
				icon: 'error',
				confirmButtonText: 'ููุงูู',
				reverseButtons: true,
			});
		}
	}
	// Click Completion Button
	document.querySelector(".dropdown.allam-help .completion").addEventListener("click", (e) => {
		e.preventDefault(); // Prevent page reload
		allamCompletion(); 
	});
	// Click On Close Completion
	document.querySelector(".response-completion .close-icon").addEventListener("click", () => {
		document.querySelector(".response-completion").style.display = "none";
		window.scrollBy({top: -420});	
	});


	// @@@@@@@@@@@ Allam Titles @@@@@@@@@@@
	async function allamTitles() {
		var sittingErrMsg = document.querySelector(".sitting-error-msg");
		// Get All Text
		var AllStory = document.querySelectorAll(".page .text");
		var fullStory = "";
		AllStory.forEach(text => {fullStory += text.textContent.trim() + " "})
		
		// If Text Is Empty
		if (fullStory.trim().length == 0) {
			sittingErrMsg.innerHTML = "ูุง ููุฌุฏ ูุต ููุชุญูู ูููุ ุฃุถู ูุตุงู ุฃููุงู"
			sittingErrMsg.style.opacity = 1;
			setTimeout(() => {sittingErrMsg.style.opacity = 0;}, 5000); 
			return;
		}
		// If Text Is Short
		else if (fullStory.length < 200) {
			sittingErrMsg.innerHTML = "ูุฌุจ ุฃู ุชููู ุงููุตุฉ ุจุทูู 200 ุญุฑูุง ูุฃูุซุฑ ููุชููู ูููููู ูู ุงูุชุฑุงุญ ุงูุนูุงููู!"
			sittingErrMsg.style.opacity = 1;
			setTimeout(() => {sittingErrMsg.style.opacity = 0;}, 5000); 
			return;
		}
		// If Text Is Not Arabic
		else if (!arabicRegex.test(fullStory) ) {
			sittingErrMsg.innerHTML = "ูุฌุจ ุฅุฏุฎุงู ุงููุตูุต ุจุงููุบุฉ ุงูุนุฑุจูุฉ ููุท";
			sittingErrMsg.style.opacity = 1;
			setTimeout(() => {sittingErrMsg.style.opacity = 0;}, 5000); 
			return;
		}
		// ุงููููุงุช ุงููุญุธูุฑุฉ
		if (checkForbiddenWords(fullStory)) {
			return;
		}
		else {
			sittingErrMsg.style.opacity = 0; // Remove Error Message
		}

		// Send To Allam
		const data = { message: fullStory }; 

		 // ุฅุธูุงุฑ ุฑุณุงูุฉ ุงูุชุญููู
		Swal.fire({
            title: 'ุฌุงุฑู ุงูุดุงุก ุงูุนูุงููู ุงูููุชุฑุญุฉ...',
            text: 'ุงูุฑุฌุงุก ุงูุงูุชุธุงุฑ ููููุงู',
            allowOutsideClick: false,
            showConfirmButton: false,
            didOpen: () => {
                Swal.showLoading(); // ุนุฑุถ ุงููุคุดุฑ ุงูุฏุงุฆุฑู
            }
        });

		try {
            const response = await fetch('http://127.0.0.1:5000/allam-titles', {
				method: 'POST',
				headers: { 'Content-Type': 'application/json' },
				body: JSON.stringify(data)
			});

            Swal.close(); // ุฅุบูุงู ุฑุณุงูุฉ ุงูุชุญููู ุจูุฌุฑุฏ ุงุณุชูุงู ุงูุฑุฏ
			
            if (!response.ok) {
                throw new Error('ูุดู ุงูุงุชุตุงู ุจุงูุฎุงุฏู. ุญุงูู ูุฑุฉ ุฃุฎุฑู.');
            }
			
            var result = await response.json();
            result = JSON.parse(result.response); // ุชุญููู ุงููุต ุฅูู JSON

			Swal.fire({
				title: 'ุชูุช ูุนุงูุฌุฉ ุทูุจู',
				icon: 'success',
				confirmButtonText: 'ุชููุฏ ุงูุนูุงููู ุงูููุชุฑุญุฉ',
				reverseButtons: true, 
			})
			
			// Show Response To User
			var TitlesContain  = document.querySelector(".response-titles");
			TitlesContain.style.display = "block";

			const ulElement = TitlesContain.querySelector(".text ul");
			ulElement.innerHTML = ""; // ูุณุญ ุงููุญุชูู ุงูุญุงูู ุฏุงุฎู <ul> ุฅุฐุง ูุงู ููุฌูุฏูุง
			// ุฅุถุงูุฉ ูู ุนูุตุฑ ูู ุงููุตูููุฉ ูุนูุตุฑ <li>
			result.forEach((title) => {
				const liElement = document.createElement("li"); // ุฅูุดุงุก ุนูุตุฑ <li>
				liElement.textContent = title; // ุชุนููู ุงููุต ููุนูุตุฑ
				ulElement.appendChild(liElement); // ุฅุถุงูุฉ <li> ุฅูู <ul>
			});
						
			// Go Down To Titles
			const offset = window.innerHeight * 0.1; // 30% ูู ุงุฑุชูุงุน ุงูุดุงุดุฉุ ุงุฌุนููุง ุฃูุจุฑ ูุชุฒูุฏ ุงููุณุงูุฉ
			const TopTitles = TitlesContain.getBoundingClientRect().top + window.pageYOffset;
			window.scrollTo({ 
				top: TopTitles + offset, // ุฅุถุงูุฉ ุงูู offset ูุฌุนู ุงูุชูุฑูุฑ ููุฒู ุฃูุซุฑ
				behavior: 'smooth' 
			});

		} catch (error) {
			Swal.close(); // ุฅุบูุงู ุฑุณุงูุฉ ุงูุชุญููู ุนูุฏ ุญุฏูุซ ุฎุทุฃ
			Swal.fire({
				title: 'ุฎุทุฃ!',
				text: error.message,
				icon: 'error',
				confirmButtonText: 'ููุงูู',
				reverseButtons: true,
			});
		}
	}
	// Click Titles Button
	document.querySelector(".dropdown.allam-help .titles").addEventListener("click", (e) => {
		e.preventDefault(); // Prevent page reload
		allamTitles(); 
	});
	// Click On Close Titles
	document.querySelector(".response-titles .close-icon").addEventListener("click", () => {
		document.querySelector(".response-titles").style.display = "none";
		window.scrollBy({top: -420});	
	});



	// @@@@@@@@@@@ Allam Feedback @@@@@@@@@@@
	async function allamFeedback() {
		var sittingErrMsg = document.querySelector(".sitting-error-msg");
		// Get All Text
		var AllStory = document.querySelectorAll(".page .text");
		var fullStory = "";
		AllStory.forEach(text => {fullStory += text.textContent.trim() + " "})
		
		// If Text Is Empty
		if (fullStory.trim().length == 0) {
			sittingErrMsg.innerHTML = "ูุง ููุฌุฏ ูุต ูููุฑุงุฌุนุฉุ ุฃุถู ูุตุงู ุฃููุงู"
			sittingErrMsg.style.opacity = 1;
			setTimeout(() => {sittingErrMsg.style.opacity = 0;}, 5000); 
			return;
		}
		// If Text Is Short
		else if (fullStory.length < 200) {
			sittingErrMsg.innerHTML = "ูุฌุจ ุฃู ุชููู ุงููุตุฉ ุจุทูู 200 ุญุฑูุง ูุฃูุซุฑ ููุชููู ูููููู ูุฑุงุฌุนุฉ ูุตุชู!"
			sittingErrMsg.style.opacity = 1;
			setTimeout(() => {sittingErrMsg.style.opacity = 0;}, 5000); 
			return;
		}
		// If Text Is Not Arabic
		else if (!arabicRegex.test(fullStory) ) {
			sittingErrMsg.innerHTML = "ูุฌุจ ุฅุฏุฎุงู ุงููุตูุต ุจุงููุบุฉ ุงูุนุฑุจูุฉ ููุท";
			sittingErrMsg.style.opacity = 1;
			setTimeout(() => {sittingErrMsg.style.opacity = 0;}, 5000); 
			return;
		}
		// ุงููููุงุช ุงููุญุธูุฑุฉ
		if (checkForbiddenWords(fullStory)) {
			return;
		}
		else {
			sittingErrMsg.style.opacity = 0; // Remove Error Message
		}

		// Send To Allam
		const data = { message: fullStory }; 

		 // ุฅุธูุงุฑ ุฑุณุงูุฉ ุงูุชุญููู
		Swal.fire({
            title: 'ุฌุงุฑู ูุฑุงุฌุนุฉ ุงููุตุฉ ูุงูุชุฑุงุญ ุงูุชุญุณููุงุช...',
            text: 'ุงูุฑุฌุงุก ุงูุงูุชุธุงุฑ ููููุงู',
            allowOutsideClick: false,
            showConfirmButton: false,
            didOpen: () => {
                Swal.showLoading(); // ุนุฑุถ ุงููุคุดุฑ ุงูุฏุงุฆุฑู
            }
        });

		try {
            const response = await fetch('http://127.0.0.1:5000/allam-feedback', {
				method: 'POST',
				headers: { 'Content-Type': 'application/json' },
				body: JSON.stringify(data)
			});

            Swal.close(); // ุฅุบูุงู ุฑุณุงูุฉ ุงูุชุญููู ุจูุฌุฑุฏ ุงุณุชูุงู ุงูุฑุฏ
			
            if (!response.ok) {
                throw new Error('ูุดู ุงูุงุชุตุงู ุจุงูุฎุงุฏู. ุญุงูู ูุฑุฉ ุฃุฎุฑู.');
            }
			
           
			var result = await response.json();
			var result_br = result.response.replace(/\n/g, "<br>");

			Swal.fire({
				title: 'ุชูุช ูุนุงูุฌุฉ ุทูุจู',
				icon: 'success',
				confirmButtonText: 'ุชููุฏ ุงููุชูุฌุฉ',
				reverseButtons: true, 
			})
			
			Swal.fire({
				title: 'ุชูุช ูุนุงูุฌุฉ ุทูุจู',
				icon: 'success',
				confirmButtonText: 'ุชููุฏ ุนูุงุตุฑ ูุตุชู',
				reverseButtons: true, 
			})
			
			// Show Response To User
			var feedbackContain  = document.querySelector(".response-feedback");

			// Go Down To Feedback
			const offset = window.innerHeight * 0.8; // 30% ูู ุงุฑุชูุงุน ุงูุดุงุดุฉุ ุงุฌุนููุง ุฃูุจุฑ ูุชุฒูุฏ ุงููุณุงูุฉ
			const TopFeedback = feedbackContain.getBoundingClientRect().top + window.pageYOffset;
			window.scrollTo({ 
				top: TopFeedback + offset, // ุฅุถุงูุฉ ุงูู offset ูุฌุนู ุงูุชูุฑูุฑ ููุฒู ุฃูุซุฑ
				behavior: 'smooth' 
			});

			feedbackContain.style.display = "block";
			feedbackContain.querySelector(".text").innerHTML = result_br;

		} catch (error) {
			Swal.close(); // ุฅุบูุงู ุฑุณุงูุฉ ุงูุชุญููู ุนูุฏ ุญุฏูุซ ุฎุทุฃ
			Swal.fire({
				title: 'ุฎุทุฃ!',
				text: error.message,
				icon: 'error',
				confirmButtonText: 'ููุงูู',
				reverseButtons: true,
			});
		}
	}
	// Click Titles Button
	document.querySelector(".dropdown.allam-help .feedback").addEventListener("click", (e) => {
		e.preventDefault(); // Prevent page reload
		allamFeedback(); 
	});
	// Click On Close Titles
	document.querySelector(".response-feedback .close-icon").addEventListener("click", () => {
		document.querySelector(".response-feedback").style.display = "none";
		window.scrollBy({top: -420});	
	});




	// @@@@@@@@@@@ Starting Ideas @@@@@@@@@@@
	var startingIdeas = document.querySelector(".response-starting");
	var dropdownStart = document.querySelector(".dropdown.allam-help .starting");
	dropdownStart.addEventListener("click", (e) => {
		e.preventDefault();
		startingIdeas.style.display = "block"; // Display Ideas
		
		// Go Down To Ideas
		const offset = window.innerHeight * 0.1; // 10% ูู ุงุฑุชูุงุน ุงูุดุงุดุฉ
		window.scrollTo({ 
			top: document.querySelector('#starting-ideas').getBoundingClientRect().top + window.pageYOffset - offset, 
			behavior: 'smooth' 
		});
	});
	// Click On Close Ideas
	document.querySelector(".response-starting .close-icon").addEventListener("click", () => {
		startingIdeas.style.display = "none";
		window.scrollBy({top: -420});	
	});
	


	// @@@@@@@@@@@ Text Counter @@@@@@@@@@@
	document.querySelectorAll(".text").forEach((textElement) => {
		const parent = textElement.parentElement; // ุงููุตูู ุฅูู ุงูุนูุตุฑ ุงูุฃุจ
		const errorMsg = parent.querySelector(".error-msg.text-error-msg"); // ุฑุณุงูุฉ ุงูุฎุทุฃ ุงูุฎุงุตุฉ ุจุงููุต ุงูุญุงูู
		const textCounterElement = parent.querySelector(".text-counter"); // ุนุฏุงุฏ ุงูุฃุญุฑู ุงูุฎุงุต ุจุงููุต ุงูุญุงูู
		const charCounter = parent.querySelector(".text-counter .charCount"); // ุนุฏุงุฏ ุงูุฃุญุฑู ุงูุฎุงุต ุจุงููุต ุงูุญุงูู
		const maxLengthElement = parent.querySelector(".text-counter .maxLength");
		const maxLength = Number(maxLengthElement?.textContent || 500); // ุงูุญุฏ ุงูุฃูุตู ููุฃุญุฑู
	
		if (textElement) {
			let timeout;
	
			// ุญุฏุซ ุงูุฅุฏุฎุงู
			textElement.addEventListener("input", () => {
				textCounterElement.style.opacity = "1";
				clearTimeout(timeout); // ุฅูุบุงุก ุงููุคูุช ุงูุณุงุจู
				timeout = setTimeout(() => {
					const currentText = textElement.innerText; // ุงุณุชุฎุฏู innerText ููุญูุงุธ ุนูู ุงูุฃุณุทุฑ ุงูุฌุฏูุฏุฉ
	
					// ุฅุฐุง ุชุฌุงูุฒ ุงููุต ุงูุญุฏ ุงูุฃูุตู
					if (currentText.length > maxLength) {
						// ูุทุน ุงููุต ุฅูู ุงูุญุฏ ุงูุฃูุตู ูุน ุงูุญูุงุธ ุนูู ุงูุชูุณูู
						const trimmedText = currentText.slice(0, maxLength);
						textElement.innerText = trimmedText;
	
						if (errorMsg) {
							errorMsg.style.opacity = 1;
							errorMsg.innerHTML = "ููุฏ ูุตูุช ุฅูู ุงูุญุฏ ุงูุฃูุตู ูู ุงูุญุฑูู. ุฃุถู ุตูุญุฉ ุฌุฏูุฏุฉ.";
						}
	
						// ุฅุนุงุฏุฉ ุงููุคุดุฑ ุฅูู ููุงูุฉ ุงููุต
						const range = document.createRange();
						const selection = window.getSelection();
						range.selectNodeContents(textElement);
						range.collapse(false);
						selection.removeAllRanges();
						selection.addRange(range);
					} else {
						if (errorMsg) {
							errorMsg.style.opacity = 0;
						}
					}
	
					// ุชุญุฏูุซ ุนุฏุงุฏ ุงูุฃุญุฑู
					if (charCounter) charCounter.textContent = currentText.length;
				}, 100); // ุชุฃุฎูุฑ ุจุณูุท ูุชุญุณูู ุงูุฃุฏุงุก
			});
	
			// ููุน ูุตู ุงููุตูุต ุงูุชู ุชุชุฌุงูุฒ ุงูุญุฏ ุงูุฃูุตู
			textElement.addEventListener("paste", (event) => {
				event.preventDefault();
				let pastedText = event.clipboardData
					.getData("text")
					.slice(0, maxLength - textElement.innerText.length); // ุงุณุชุฎุฏู innerText ุจุฏู textContent
				document.execCommand("insertText", false, pastedText);
			});
		}
	});
	
	// @@@@@@@@@@@ Text Sitting @@@@@@@@@@@
	// ุชูุญูุฏ ุณุชุงูู ุงููุต ุฏุงุฎู ุตูุญุฉ ุงููุชุงุจุฉ
	document.querySelector(".page .text").addEventListener('paste', (event) => {
		event.preventDefault(); // ููุน ุงูุณููู ุงูุงูุชุฑุงุถู
		const text = (event.clipboardData || window.clipboardData).getData('text/plain'); // ุงูุญุตูู ุนูู ุงููุต ุงูุฎุงู ูู ุงูุญุงูุธุฉ
		document.execCommand('insertText', false, text); // ุฅุฏุฎุงู ุงููุต ุฏุงุฎู ุงูุนูุตุฑ ุจุฏูู ุชูุณูู
	});
	
	
	
	// @@@@@@@@@@@ Save Story @@@@@@@@@@@
	// Call Save Story Function
	// ูุณุชูุน ูุฒุฑ ุงูุฎุฑูุฌ
	var outBtn = document.querySelector(".out-btn");
	outBtn.addEventListener("click", () => {
		handleUserExit()
	})
	// ูุณุชูุน ูุญุฏุซ beforeunload
	window.addEventListener('beforeunload', (event) => {
		// ุนุฑุถ ูุงูุฐุฉ ุชุญุฐูุฑูุฉ ุจุงููุบุฉ ุงูุนุฑุจูุฉ
		//const userConfirmed = confirm('ุฅุฐุง ุฎุฑุฌุช ุงูุขู ุฏูู ุญูุธ ุงููุตุฉุ ูุฏ ุชุถูุน ูุตุชู ุงูุฌูููุฉ! ูู ุชุฑูุฏ ุญูุธูุง ูุจู ุงููุบุงุฏุฑุฉุ');
		// ุฅุฐุง ูุงูู ุงููุณุชุฎุฏู ุนูู ุงููุบุงุฏุฑุฉุ ูุชุฑู ุงูุญุฏุซ ูุนูู
		//if (!userConfirmed) {
			// ููุน ุงููุบุงุฏุฑุฉ
		//	event.preventDefault();
		//	event.returnValue = '';
		//} else {
			// ุชูููุฐ ุฅุฌุฑุงุก ูุนูู ุนูุฏ ุงููุบุงุฏุฑุฉ (ุงุฎุชูุงุฑู)
		//	handleUserExit();
		//}
	});
	
	// Click On Save Button
	var saveBtn = document.querySelector(".save-btn");
	saveBtn.addEventListener("click",async () => {
		// Get Elements
		var title = document.querySelector(".page.cover-page .front .title");
		var titleText = document.querySelector(".page.cover-page .front .title").value;
        var storyID = document.querySelector(".edit-user-story").dataset.storyId;

		// Image
		var image = document.querySelector(".page.cover-page .front .cover-img");
		var imageSrc = "";
		if (image) {
			imageSrc = image.getAttribute("src").split('?')[0].split('/').pop();
		}

		// Audio
		var audio = document.querySelector(".record audio");
		var audioSrc = "";
		if (audio) {
			audioSrc = audio.getAttribute("src").split('?')[0].split('/').pop()
		}

		// Get All Story Audio Sources
		var allgenerAudioSources = document.querySelectorAll(".page audio source");

		// Store Audio Sources in an Array
		var generAudiosArray = []; // ุชุนุฑูู ูุตูููุฉ ูุชุฎุฒูู ุงููุตูุต
		allgenerAudioSources.forEach(audioSource => {
		// ุงุญุตู ุนูู ูููุฉ src ููู ุนูุตุฑ ููู ุจูุนุงูุฌุชูุง
			let src = audioSource.getAttribute("src").split('?')[0].split('/').pop().trim();
			generAudiosArray.push(src); // ุฃุถู ุฅูู ุงููุตูููุฉ
		});
		
		// Get All Text As One String
		var AllStory = document.querySelectorAll(".page .text");
		var fullStory = "";
		AllStory.forEach(text => { fullStory += text.textContent.trim() + " " ;console.log(text)});
		// Stor Story In Array
		var fullStoryArray = []; // ุชุนุฑูู ูุตูููุฉ ูุชุฎุฒูู ุงููุตูุต
		AllStory.forEach(text => {
		fullStoryArray.push(text.textContent.trim())}); // ุฅุถุงูุฉ ุงููุตูุต ุฅูู ุงููุตูููุฉ

		// If Title Is Not Arabic
		if (!titleText.trim()) { 
			console.log("ุงูุนููุงู ูุงุฑุบุ ูุง ุญุงุฌุฉ ููุชุญูู.");
			// ูููู ุชุฑู ุงูุญูู ูุงุฑุบูุง ูุงูุงุณุชูุฑุงุฑ ูู ุชูููุฐ ุงูุฃููุงุฏ ุงูุชุงููุฉ
		} else if (!arabicRegex.test(titleText)) {
			Swal.fire({
				title: 'ุฎุทุฃ!',
				text: "ูุฌุจ ุฅุฏุฎุงู ุนููุงู ุงููุตุฉ ุจุงููุบุฉ ุงูุนุฑุจูุฉ ููุท",
				icon: 'error',
				confirmButtonText: 'ููุงูู',
				reverseButtons: true,
			});
			return; // ุงูุฎุฑูุฌ ููุท ูู ุญุงูุฉ ุงููุต ุบูุฑ ุงูุนุฑุจู
		}
		const data = {
            id: storyID || null, // ุฅุถุงูุฉ ุงูู ID ุงูุฎุงุต ุจุงููุตุฉ
            title: titleText || null,
            imageSrc: imageSrc || "",
            audioSrc: audioSrc || "",
			genertedAudiosSrcs: generAudiosArray || "", 
            message: fullStoryArray || ""
        };

		console.log(data)
		// Call function to send the story
		await SendStory(data);
	})
	
	//Save Story Function
	async function handleUserExit(event) {
		// Get Elements
		var storyID = document.querySelector(".edit-user-story").dataset.storyId;
		var title = document.querySelector(".page.cover-page .front .title");

		// Image
		var image = document.querySelector(".page.cover-page .front .cover-img");
		var imageSrc = "";
		if (image) {
			imageSrc = image.getAttribute("src").split('?')[0].split('/').pop();
		}
		// Audio
		var audio = document.querySelector(".record audio");
		var audioSrc = "";
		if (audio) {
			audioSrc = audio.getAttribute("src").split('?')[0].split('/').pop()
		}

		// Get All Story Audio Sources
		var allgenerAudioSources = document.querySelectorAll(".page audio source");

		// Store Audio Sources in an Array
		var generAudiosArray = []; // ุชุนุฑูู ูุตูููุฉ ูุชุฎุฒูู ุงููุตูุต
		allgenerAudioSources.forEach(audioSource => {
		// ุงุญุตู ุนูู ูููุฉ src ููู ุนูุตุฑ ููู ุจูุนุงูุฌุชูุง
			let src = audioSource.getAttribute("src").split('?')[0].split('/').pop().trim();
			generAudiosArray.push(src); // ุฃุถู ุฅูู ุงููุตูููุฉ
		});
		
		// Get All Text
		var AllStory = document.querySelectorAll(".page .text");
		var fullStory = "";
		AllStory.forEach(text => { fullStory += text.textContent.trim() + " " });
		// Stor Story In Array
		var fullStoryArray = []; // ุชุนุฑูู ูุตูููุฉ ูุชุฎุฒูู ุงููุตูุต
		AllStory.forEach(text => {
		fullStoryArray.push(text.textContent.trim())}); // ุฅุถุงูุฉ ุงููุตูุต ุฅูู ุงููุตูููุฉ

		// Check If At Least One Exists
		if (!title.value && !imageSrc && !fullStory.trim()) {
			window.location.href = '/writing/user-stories'; // Go To Writing Types Page
		} else {
			
			// Sweet Alert
			Swal.fire({
				title: 'ุญูุธ ุงููุตุฉ',
				text: 'ุฅุฐุง ุฎุฑุฌุช ุงูุขู ุฏูู ุญูุธ ุงููุตุฉุ ูุฏ ุชุถูุน ูุตุชู ุงูุฌูููุฉ! ูู ุชุฑูุฏ ุญูุธูุง ูุจู ุงููุบุงุฏุฑุฉุ',
				icon: 'info',
				showCancelButton: true,
				confirmButtonText: 'ูุนู ุงุญูุธูุง',
				cancelButtonText: 'ูุง ุฃุฑูุฏ ุญูุธูุง',
				reverseButtons: true // Swaps the position of confirm and cancel buttons
			}).then(async (result) => { // ุชุฃูุฏ ูู ุฌุนู ุงูุฏุงูุฉ ุฏุงุฎู then ูุชุฒุงููุฉ
				if (result.isConfirmed) {
					var titleText = document.querySelector(".page.cover-page .front .title").value;
	
					// If Title Is Not Arabic
					if (!titleText.trim()) { 
						console.log("ุงูุนููุงู ูุงุฑุบุ ูุง ุญุงุฌุฉ ููุชุญูู.");
						// ูููู ุชุฑู ุงูุญูู ูุงุฑุบูุง ูุงูุงุณุชูุฑุงุฑ ูู ุชูููุฐ ุงูุฃููุงุฏ ุงูุชุงููุฉ
					} else if (!arabicRegex.test(titleText)) {
						Swal.fire({
							title: 'ุฎุทุฃ!',
							text: "ูุฌุจ ุฅุฏุฎุงู ุนููุงู ุงููุตุฉ ุจุงููุบุฉ ุงูุนุฑุจูุฉ ููุท",
							icon: 'error',
							confirmButtonText: 'ููุงูู',
							reverseButtons: true,
						});
						return; // ุงูุฎุฑูุฌ ููุท ูู ุญุงูุฉ ุงููุต ุบูุฑ ุงูุนุฑุจู
					}

					const data = {
                        id: storyID || null, // ุฅุถุงูุฉ ุงูู ID ุงูุฎุงุต ุจุงููุตุฉ
                        title: title.value || null,
                        imageSrc: imageSrc || "",
                        audioSrc: audioSrc || "",
						genertedAudiosSrcs: generAudiosArray || "", 
                        message: fullStoryArray || ""
                    };
                    
					
					// Call function to send the story
					if (await SendStory(data))
						setTimeout(() => {window.location.href = '/writing/user-stories'},800)

				}
				else if (result.isDismissed) {
					window.location.href = '/writing/user-stories'; // Go To Writing Types Page
				}
			});
		}
	}
	
	async function SendStory(data) {
		try {
			// Show loading alert
			Swal.fire({
				title: 'ุฌุงุฑู ุชุญุฏูุซ ูุตุชู...',
				text: 'ุงูุฑุฌุงุก ุงูุงูุชุธุงุฑ ููููุงู',
				allowOutsideClick: false,
				showConfirmButton: false,
				didOpen: () => {
					Swal.showLoading(); // ุนุฑุถ ุงููุคุดุฑ ุงูุฏุงุฆุฑู
				}
			});
	
			// Send data to the server
			const response = await fetch('http://127.0.0.1:5000/update-user-story', {
				method: 'POST',
				headers: { 'Content-Type': 'application/json' },
				body: JSON.stringify(data)
			});
	
			// Handle response
			if (response.ok) {
				let result = await response.json(); 
				if (result.imageUpdated) { // ุชุญูู ุฅุฐุง ูุงูุช ุงูุตูุฑุฉ ูุฏ ุชู ุชุญุฏูุซูุง
					let storyID = result.storyID; // ุฌูุจ ID ุงููุตุฉ ูู ุงูุฎุงุฏู
					var userID = result.userID;  // ุฌูุจ ID ุงููุณุชุฎุฏู ูู ุงูุฎุงุฏู
					var imageFormat = result.imageFormat; 
					// ุชุญุฏูุซ ุตูุฑุฉ ุงููุตุฉ ูู ุงููุงุฌูุฉ
					const newImageName = `/static/images/users/${userID}/${userID}_${storyID}${imageFormat}`;
					document.querySelector(".page.cover-page .front .cover-img").setAttribute("src", newImageName);
					console.log("ุชู ุชุญุฏูุซ ุตูุฑุฉ ุงููุตุฉ:", newImageName);
				} else {
					console.log("ูุง ุชูุฌุฏ ุตูุฑุฉ ุฌุฏูุฏุฉ ูุชุญุฏูุซูุง.");
			}		
			Swal.fire('ุชู ุชุญุฏูุซ ุงููุตุฉ!', '', 'success');
			return true;
			} else {
				const result = await response.json();
				if (result.status === "duplicate") {
					console.log(result)
					Swal.fire({
						title: 'ุงูุนููุงู ููุฌูุฏ!',
						text: 'ููุงู ูุตุฉ ุฃุฎุฑู ุจููุณ ุงูุนููุงู. ูุฑุฌู ุงุฎุชูุงุฑ ุนููุงู ุฌุฏูุฏ.',
						icon: 'error',
						confirmButtonText: 'ุญุณูุง'
					});
				} else {
					Swal.fire({
						title: 'ูุดู ุชุญุฏูุซ ุงููุตุฉ',
						text: 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุชุญุฏูุซ ุงููุตุฉ.',
						icon: 'error',
						confirmButtonText: 'ุญุงูู ูุฑุฉ ุฃุฎุฑู'
					});
				}
			}
		} catch (error) {
			Swal.fire({
				title: 'ูุดู ุงูุชุญุฏูุซ',
				text: 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุชูุงุตู ูุน ุงูุฎุงุฏู',
				icon: 'error',
				confirmButtonText: 'ุญุณูุง' // ุชุบููุฑ ุงููุต ุฅูู "ุญุณูุง"
			});			
			console.error(error);
		}
	}
	
	
});
</script>
<script src="../../static/js/voice_recorder.js"></script>
{% endblock %}
<!-- Copyright (c) 2024 by Timo Hausmann (https://codepen.io/timohausmann/pen/AaJWvo) -->